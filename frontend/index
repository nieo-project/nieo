<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NIEO.AI</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
html,body{height:100%;width:100%;}
body{background:#f9f9f9;color:#000;transition:0.3s;font-size:1rem;display:flex;justify-content:center;align-items:center;}
body.dark{background:#121212;color:#fff;}
.app-container{width:95%;max-width:480px;height:95vh;display:flex;flex-direction:column;position:relative;border-radius:1rem;overflow:hidden;box-shadow:0 6px 20px rgba(0,0,0,0.2);}
.header{height:12%;min-height:50px;display:flex;align-items:center;justify-content:space-between;padding:0 3%;background:rgba(255,255,255,0.95);}
body.dark .header{background:rgba(30,30,30,0.95);}
.logo-img{height:40px;cursor:pointer;}
.menu-btn{width:2.5rem;height:2.5rem;border:none;border-radius:.75rem;background:linear-gradient(45deg,#00ffe0,#0076ff);color:#fff;font-size:1.2rem;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:0.2s;}
.menu-btn:hover{transform:scale(1.05);}
.menu-items{position:absolute;top:12%;right:3%;display:none;flex-direction:column;gap:.5rem;padding:1rem;border-radius:.75rem;background:rgba(255,255,255,0.95);z-index:99;min-width:40%;box-shadow:0 6px 20px rgba(0,0,0,0.2);}
body.dark .menu-items{background:rgba(30,30,30,0.95);}
.menu-items button, .menu-items a{font-weight:500;color:#000;cursor:pointer;background:none;border:none;padding:.4rem .6rem;border-radius:.5rem;text-align:left;transition:0.2s;font-size:.9rem;text-decoration:none;}
body.dark .menu-items button, body.dark .menu-items a{color:#fff;}
.menu-items button:hover, .menu-items a:hover{background:linear-gradient(45deg,#00ffe0,#0076ff);color:#000;}
.theme-toggle{width:2.5rem;height:1.4rem;border-radius:50px;background:linear-gradient(45deg,#00ffe0,#0076ff);position:relative;cursor:pointer;transition:0.3s;margin-bottom:.5rem;}
.theme-toggle-circle{width:1.1rem;height:1.1rem;border-radius:50%;background:#fff;position:absolute;top:.15rem;left:.15rem;transition:0.3s;}
.theme-toggle.active .theme-toggle-circle{left:1.25rem;}
.chat-box{flex:1;padding:1rem;overflow-y:auto;display:flex;flex-direction:column;gap:.5rem;scroll-behavior:smooth;}
.bot-msg,.user-msg{padding:.6rem 1rem;border-radius:1rem;max-width:80%;word-wrap:break-word;animation:fadeIn .3s;box-shadow:0 2px 10px rgba(0,0,0,0.1);}
.bot-msg{background:rgba(0,0,0,0.05);align-self:flex-start;font-size:.95rem;}
body.light .bot-msg{background:#e0f7fa;color:#000;}
.user-msg{background:linear-gradient(45deg,#00ffe0,#0076ff);color:#000;align-self:flex-end;text-align:right;font-size:.95rem;}
.input-area{display:flex;padding:.5rem;background:rgba(255,255,255,0.9);}
body.dark .input-area{background:rgba(40,40,60,0.9);}
input{flex:1;padding:.5rem 1rem;border-radius:1.25rem;border:none;outline:none;font-size:1rem;background:#fff;color:#000;}
body.dark input{background:#3a3a50;color:#e0e0e0;}
.send-btn{width:2.5rem;height:2.5rem;border:none;border-radius:50%;background:linear-gradient(45deg,#00ffe0,#0076ff);color:#fff;font-size:1.2rem;display:flex;align-items:center;justify-content:center;transition:0.2s;margin-left:.5rem;}
.send-btn:hover{transform:scale(1.05);}
.news-card{border-radius:.75rem;padding:.6rem;background:#f0f0f0;margin-bottom:.5rem;}
body.dark .news-card{background:#1a1a1a;color:#fff;}
.news-card h4{margin-bottom:.3rem;font-size:.9rem;}
.news-card a{color:#00796b;text-decoration:none;font-weight:bold;font-size:.85rem;}
body.dark .news-card a{color:#00ffe0;}
.popup{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:200;}
.popup-content{background:#fff;color:#000;padding:1rem;border-radius:.75rem;width:90%;max-width:380px;max-height:80%;overflow-y:auto;display:flex;flex-direction:column;justify-content:space-between;}
body.dark .popup-content{background:#2a2a40;color:#fff;}
.popup-content h2{text-align:center;color:#00796b;margin-bottom:.5rem;font-size:1rem;}
.popup-content p{line-height:1.5;flex:1;font-size:.85rem;margin-bottom:.3rem;color:#555;}
.popup-content a{color:#0076ff;font-weight:bold;text-decoration:none;}
.popup-content button{display:block;margin:.5rem auto 0;padding:.4rem 1rem;border:none;border-radius:.75rem;background:#00ffe0;color:#000;font-weight:bold;cursor:pointer;font-size:.85rem;}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}
</style>
</head>
<body class="light">

<div class="app-container">
  <div class="header">
    <img src="assets/logo.png" alt="NIEO.AI Logo" class="logo-img" onclick="window.open('https://www.instagram.com/nieo.ai/','_blank')">
    <button class="menu-btn" onclick="toggleMenu()">☰</button>
  </div>

  <div class="menu-items" id="menuItems">
    <div class="theme-toggle" id="themeToggle"><div class="theme-toggle-circle"></div></div>
    <button onclick="showPP()">Privacy & Policy</button>
    <a href="https://www.instagram.com/_fayizeeyy/" target="_blank">Creator</a>
  </div>

  <div class="chat-box" id="chatBox"></div>

  <div class="input-area">
    <input type="text" id="userInput" placeholder="Type a topic or question...">
    <button class="send-btn" onclick="sendMessage()">➤</button>
  </div>
</div>

<div class="popup" id="popup">
  <div class="popup-content">
    <h2>Privacy & Policy</h2>
    <p>We respect your privacy and do not store personal data.</p>
    <p>News is fetched from reliable sources.</p>
    <p>Visit updates and enquiries: <a href="https://www.instagram.com/nieo.ai/" target="_blank">nieo.ai</a></p>
    <p style="font-size:0.75rem;color:#888;">All rights reserved © <a href="https://www.nieo.ai" target="_blank">nieo.ai</a> & team since 2025</p>
    <button onclick="closePP()">Close</button>
  </div>
</div>

<script>
const chatBox = document.getElementById("chatBox");
const popup = document.getElementById("popup");
const menuItems = document.getElementById("menuItems");
const themeToggle = document.getElementById("themeToggle");

// Menu toggle
function toggleMenu(){menuItems.style.display = menuItems.style.display==="flex"?"none":"flex";}
document.addEventListener('click', e => {
  if(!menuItems.contains(e.target) && !e.target.classList.contains('menu-btn')) menuItems.style.display="none";
});
menuItems.querySelectorAll("button, a").forEach(el => el.addEventListener("click", () => menuItems.style.display="none"));

// Theme toggle
themeToggle.addEventListener('click', () => {
  themeToggle.classList.toggle('active');
  document.body.classList.toggle('dark');
  document.body.classList.toggle('light');
});

// Popup
function showPP(){popup.style.display="flex";}
function closePP(){popup.style.display="none";}

// Send messages
document.getElementById("userInput").addEventListener("keypress", e => {if(e.key==="Enter") sendMessage();});

function sendMessage(){
  const topic = document.getElementById("userInput").value.trim();
  if(!topic) return;
  addMessage(topic,"user");
  document.getElementById("userInput").value = "";

  const tempMsg = addMessage("Fetching news & AI response...","bot");

  const encodedTopic = encodeURIComponent(topic);

  // ✅ Updated backend links (FastAPI hosted on Vercel)
  fetch(`https://nieo-project.vercel.app/news?topic=${encodedTopic}`)
    .then(res => res.json())
    .then(data => {
      if(tempMsg) tempMsg.remove();
      if(data.articles && Array.isArray(data.articles) && data.articles.length>0){
        data.articles.forEach(n => {
          addMessage(`<div class='news-card'><h4>${n.title}</h4><a href="${n.link}" target="_blank">Read more →</a></div>`,"bot");
        });
      } else addMessage("No news found for this topic.","bot");
    })
    .catch(()=> addMessage("Error fetching news. Make sure backend is deployed.","bot"));

  // Optional AI chat endpoint
  fetch(`https://nieo-project.vercel.app/chat?message=${encodedTopic}`)
    .then(res => res.json())
    .then(data => { if(data.reply) addMessage(data.reply,"bot"); })
    .catch(()=> console.log("AI chat fetch failed"));
}

function addMessage(text,sender){
  const msg = document.createElement("div");
  msg.className = sender+"-msg";
  msg.innerHTML = text;
  chatBox.appendChild(msg);
  chatBox.scrollTo({ top: chatBox.scrollHeight, behavior: 'smooth' });
  return msg;
}
</script>
</body>
</html>
